<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Ball Tower Climber">
    <title>Ball Tower Climber</title>
    
    <!-- Manifest for PWA -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" href="icon-192.png" type="image/png">
    <link rel="apple-touch-icon" href="icon-192.png">
    
    <!-- CSS -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    
    <style>
        /* Prevent text selection and touch callout */
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        
        /* iOS Standalone fixes */
        @supports (-webkit-touch-callout: none) {
            body {
                /* iOS padding fix */
                padding-top: env(safe-area-inset-top);
                padding-bottom: env(safe-area-inset-bottom);
                padding-left: env(safe-area-inset-left);
                padding-right: env(safe-area-inset-right);
            }
            
            body.standalone {
                padding-top: max(20px, env(safe-area-inset-top));
                padding-bottom: max(20px, env(safe-area-inset-bottom));
            }
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- START SCREEN -->
        <div id="start-screen" class="screen active">
            <div class="main-menu">
                <div class="game-title-container">
                    <h1 class="game-title">BALL TOWER CLIMBER</h1>
                    <div class="title-ball"></div>
                </div>
                
                <div class="menu-buttons">
                    <button id="play-btn" class="menu-btn">
                        <i class="fas fa-play"></i> Play
                    </button>
                    <button id="balls-btn" class="menu-btn">
                        <i class="fas fa-basketball-ball"></i> Choose Ball
                    </button>
                    <button id="upgrades-btn" class="menu-btn">
                        <i class="fas fa-sliders-h"></i> Upgrades
                    </button>
                    <button id="settings-btn" class="menu-btn">
                        <i class="fas fa-cogs"></i> Settings
                    </button>
                </div>
                
                <div class="stats-bar">
                    <div class="stat-item">
                        <i class="fas fa-coins"></i>
                        <span id="total-coins">0</span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-trophy"></i>
                        Highscore: <span id="best-score">0</span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-basketball-ball"></i>
                        Balls: <span id="unlocked-balls-count">1/4</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- BALLS SELECTION SCREEN -->
        <div id="balls-screen" class="screen">
            <div class="screen-header">
                <button class="back-btn">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <h2><i class="fas fa-basketball-ball"></i> Choose Ball</h2>
                <div class="coins-display">
                    <i class="fas fa-coins"></i> <span id="balls-coins">0</span>
                </div>
            </div>
            
            <div class="balls-grid">
                <!-- Standard Ball -->
                <div class="ball-card" data-ball="standard">
                    <div class="ball-icon standard-ball">
                        <i class="fas fa-check selected-icon"></i>
                    </div>
                    <div class="ball-info">
                        <h3>Standard</h3>
                        <p>Balanced ball for beginners</p>
                    </div>
                    <button class="ball-action-btn select-btn selected">Selected</button>
                </div>
                
                <!-- Rubber Ball -->
                <div class="ball-card locked" data-ball="rubber">
                    <div class="ball-icon rubber-ball">
                        <i class="fas fa-lock lock-icon"></i>
                    </div>
                    <div class="ball-info">
                        <h3>Rubber Ball</h3>
                        <p>Better bounce, less control</p>
                        <div class="ball-price">
                            <i class="fas fa-coins"></i> 50
                        </div>
                    </div>
                    <button class="ball-action-btn unlock-btn">Unlock</button>
                </div>
                
                <!-- Beach Ball -->
                <div class="ball-card locked" data-ball="beach">
                    <div class="ball-icon beach-ball">
                        <i class="fas fa-lock lock-icon"></i>
                    </div>
                    <div class="ball-info">
                        <h3>Beach Ball</h3>
                        <p>Lightweight, wind affected</p>
                        <div class="ball-price">
                            <i class="fas fa-coins"></i> 100
                        </div>
                    </div>
                    <button class="ball-action-btn unlock-btn">Unlock</button>
                </div>
                
                <!-- Golf Ball -->
                <div class="ball-card locked" data-ball="golf">
                    <div class="ball-icon golf-ball">
                        <i class="fas fa-lock lock-icon"></i>
                    </div>
                    <div class="ball-info">
                        <h3>Golf Ball</h3>
                        <p>Fast, precise control</p>
                        <div class="ball-price">
                            <i class="fas fa-coins"></i> 150
                        </div>
                    </div>
                    <button class="ball-action-btn unlock-btn">Unlock</button>
                </div>
            </div>
            
            <div class="selected-ball-display">
                <h3>Selected: <span id="selected-ball-name">Standard Ball</span></h3>
            </div>
        </div>
        
        <!-- UPGRADES SCREEN -->
        <div id="upgrades-screen" class="screen">
            <div class="screen-header">
                <button class="back-btn">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <h2><i class="fas fa-sliders-h"></i> Upgrades</h2>
                <div class="coins-display">
                    <i class="fas fa-coins"></i> <span id="upgrades-coins">0</span>
                </div>
            </div>
            
            <div class="ball-selector-tabs">
                <button class="ball-tab active" data-ball="standard">Standard</button>
                <button class="ball-tab" data-ball="rubber">Rubber</button>
                <button class="ball-tab" data-ball="beach">Beach</button>
                <button class="ball-tab" data-ball="golf">Golf</button>
            </div>
            
            <div class="upgrades-list-container">
                <div class="upgrades-list">
                    <!-- Upgrades will be populated dynamically -->
                    <div class="upgrade-item">
                        <div class="upgrade-header">
                            <h4>Jump Power</h4>
                            <div class="upgrade-level">Level <span class="current-level">1</span>/5</div>
                        </div>
                        <p class="upgrade-desc">Increases jump height by 10%</p>
                        <div class="upgrade-stats">
                            <div class="stat-bar">
                                <div class="stat-fill" style="width: 20%"></div>
                            </div>
                            <div class="upgrade-cost">
                                <i class="fas fa-coins"></i> <span>50</span>
                            </div>
                        </div>
                        <div class="upgrade-actions">
                            <button class="toggle-btn active">ON</button>
                            <button class="buy-btn">Buy Upgrade</button>
                        </div>
                    </div>
                    
                    <!-- More upgrades will be added dynamically -->
                </div>
            </div>
        </div>
        
        <!-- SETTINGS SCREEN -->
        <div id="settings-screen" class="screen">
            <div class="screen-header">
                <button class="back-btn">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <h2><i class="fas fa-cogs"></i> Settings</h2>
            </div>
            
            <div class="settings-list-container">
                <div class="settings-list">
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4><i class="fas fa-arrow-up"></i> Auto Jump</h4>
                            <p>Automatically jump when landing on a platform</p>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="auto-jump" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4><i class="fas fa-mobile-alt"></i> Mobile Controls</h4>
                            <p>Enable touch controls on mobile devices</p>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="mobile-controls" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4><i class="fas fa-compass"></i> Accelerometer</h4>
                            <p>Use device tilt for movement control</p>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="accelerometer" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4><i class="fas fa-wind"></i> Wind Effects</h4>
                            <p>Enable wind simulation in game</p>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="wind-effects" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4><i class="fas fa-volume-up"></i> Sound Effects</h4>
                            <p>Enable game sound effects</p>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="sound-effects" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4><i class="fas fa-music"></i> Background Music</h4>
                            <p>Play background music during game</p>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="bg-music" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4><i class="fas fa-bug"></i> Debug Info</h4>
                            <p>Show debug information on screen</p>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="debug-info">
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4><i class="fas fa-paint-brush"></i> Visual Effects</h4>
                            <p>Enable particle effects and animations</p>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="visual-effects" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="setting-section">
                        <h3><i class="fas fa-tools"></i> Debug Tools</h3>
                        
                        <button class="debug-btn" id="add-coins-btn">
                            <i class="fas fa-coins"></i> Add 1000 Coins
                        </button>
                        
                        <button class="debug-btn" id="reset-highscore-btn">
                            <i class="fas fa-trash"></i> Reset Highscore
                        </button>
                        
                        <button class="debug-btn danger" id="reset-all-btn">
                            <i class="fas fa-exclamation-triangle"></i> Reset All Progress
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- GAME SCREEN -->
        <div id="game-screen" class="screen">
            <canvas id="game-canvas"></canvas>
            
            <div class="game-hud">
                <div class="hud-top">
                    <button class="hud-btn" id="pause-game-btn">
                        <i class="fas fa-pause"></i>
                    </button>
                    <div class="score-display">
                        Score: <span id="game-score">0</span>
                    </div>
                    <div class="coins-display-hud">
                        <i class="fas fa-coins"></i> <span id="game-coins">0</span>
                    </div>
                </div>
                
                <div class="mobile-controls">
                    <div class="control-left" id="move-left-btn"></div>
                    <div class="control-right" id="move-right-btn"></div>
                </div>
            </div>
            
            <!-- PAUSE MENU -->
            <div class="pause-menu hidden">
                <div class="pause-content">
                    <h2><i class="fas fa-pause"></i> Game Paused</h2>
                    
                    <div class="pause-stats">
                        <div class="stat-box">
                            <h4>Score</h4>
                            <p class="stat-value" id="pause-score">0</p>
                        </div>
                        <div class="stat-box">
                            <h4>Height</h4>
                            <p class="stat-value" id="pause-height">0m</p>
                        </div>
                        <div class="stat-box">
                            <h4>Coins</h4>
                            <p class="stat-value" id="pause-game-coins">0</p>
                        </div>
                    </div>
                    
                    <div class="pause-buttons">
                        <button class="pause-btn" id="resume-game-btn">
                            <i class="fas fa-play"></i> Resume
                        </button>
                        <button class="pause-btn" id="restart-game-btn">
                            <i class="fas fa-redo"></i> Restart
                        </button>
                        <button class="pause-btn" id="quit-game-btn">
                            <i class="fas fa-home"></i> Main Menu
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- GAME OVER MENU -->
            <div class="game-over-menu hidden">
                <div class="game-over-content">
                    <h2><i class="fas fa-skull-crossbones"></i> Game Over</h2>
                    
                    <div class="game-over-stats">
                        <div class="stat-box">
                            <h4>Final Score</h4>
                            <p class="stat-value" id="final-score">0</p>
                        </div>
                        <div class="stat-box">
                            <h4>Height Reached</h4>
                            <p class="stat-value" id="final-height">0m</p>
                        </div>
                        <div class="stat-box">
                            <h4>Coins Collected</h4>
                            <p class="stat-value" id="final-game-coins">0</p>
                        </div>
                    </div>
                    
                    <div class="game-over-buttons">
                        <button class="game-over-btn" id="play-again-btn">
                            <i class="fas fa-redo"></i> Play Again
                        </button>
                        <button class="game-over-btn" id="back-to-menu-btn">
                            <i class="fas fa-home"></i> Main Menu
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- NOTIFICATIONS -->
    <div id="notifications"></div>
    
    <!-- SCRIPTS -->
    <script src="js/config.js"></script>
    <script src="js/game.js"></script>
    <script src="js/menu.js"></script>
    
    <script>
        // Detect standalone mode
        const isStandalone = window.matchMedia('(display-mode: standalone)').matches || 
                           window.navigator.standalone;
        
        if (isStandalone) {
            document.body.classList.add('standalone');
            console.log('Running in standalone mode');
        }
        
        // Handle iOS safe areas
        function updateSafeArea() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
            
            // Set safe area insets for iOS
            const safeAreaTop = 'env(safe-area-inset-top, 0px)';
            const safeAreaBottom = 'env(safe-area-inset-bottom, 0px)';
            
            document.documentElement.style.setProperty('--safe-top', safeAreaTop);
            document.documentElement.style.setProperty('--safe-bottom', safeAreaBottom);
        }
        
        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            updateSafeArea();
            
            // Initialize game
            if (window.Game && typeof Game.init === 'function') {
                Game.init();
            }
            
            // Initialize menu
            if (window.Menu && typeof Menu.init === 'function') {
                Menu.init();
            }
            
            // Update safe area on resize/orientation change
            window.addEventListener('resize', updateSafeArea);
            window.addEventListener('orientationchange', () => {
                setTimeout(updateSafeArea, 100);
            });
        });
        
        // Prevent default touch behaviors
        document.addEventListener('touchstart', (e) => {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });
        
        document.addEventListener('gesturestart', (e) => {
            e.preventDefault();
        });
    </script>
</body>
</html>